<html>
<head>
	<title>Финансовые отчеты - платежи клиентов</title>
</head>
<body>
<pre>Точка входа: http://188.246.224.156/api/v1.1/payments
Пример GET-запроса: https://truegamers.pro/api/v1.1/payments?type=cash&filter={"branch_id":[1,2]}&sort={"field": "date", "order": "ASC"}
Метод: GET / POST
Авторизация: Обязательна
Параметры:
  type=строка           //Тип платежа (cash / crm / online); может отсутствовать, если нужно вывести платежи всех типов
  filter=строка         //JSON-объект с параметрами фильтрации
  Формат фильтра:
    {
      "branch_id":[1,2] //массив со списком ID филиалов (может быть пустым, если нужны данные со всех филиалов)
      "date_start":"2021-01-20 00:00:00" //дата в указанном формате. Будут выведены переводы, выполненные после указанной даты (это поле можно не указывать)
      "date_end":"2021-01-21 00:00:00" //дата в указанном формате. Будут выведены переводы, выполненные до указанной даты (это поле можно не указывать)
      "user_id":45 //ID пользователя. Будут выведены переводы, полученные указанным пользователем (это поле можно не указывать)
      "card":0, //Извлечь только платежи по картам; работает, если type=cash (если 1 - извлечь только платежи по картам); необязательный параметр
      "money":1, //Извлечь только платежи наличными; работает, если type=cash (если 1 - извлечь только платежи по картам); необязательный параметр
    }
  sort=строка           //JSON-массив с параметрами сортировки (пример: sort={"field":"date_end","order":"DESC"})
Поля для сортировки:
  date - по дате/времени платежа
  user_id - по ID пользователя
  money - по сумме платежа
  branch_id - по ID филиала

Возможные ошибки:
  ERROR_EMPTY_FILTER - не указан фильтр
  ERROR_INVALID_BRANCH_ID - филиал не существует

В случае успеха скрипт отдает следующие данные:

{
    "result": "RESULT_SUCCESS", - флаг успеха
    "payload": {
        "transfers": [ - список переводов
            {
                "id": "388", - ID записи
                "date": "2021-02-07T11:17:31+03:00", - дата выполнения транзакции
                "user_id": 5, - ID пользователя
                "admin_id": 5, - id админа, работавшего в тот момент
                "description": "Платеж картой через кассу на сумму 100 руб", - описание транзакции
                "transaction_type": "card", - тип транзакции (cash / card / crm / online)
                "money": 100, - сумма перевода
                "reservation_id": "", - ID резервации
                "branch_id": 1, - ID филиала
                "branch": { - данные филиала
                    "id": 1, - ID филиала
                    "name": "Королёв", - название
                    "city": "Краснодар", - город
                    "ip": "95.181.143.212", - внешний IP
                    "currency": "РУБ", - валюта
                    "currency_code": "RUB", - код валюты
                    "time_zone": "+03:00", - таймзона
                    "local_ip": "192.168.97.205", - локальный IP
                    "local_port": "" - локальный порт
                },
                "user": { - данные получателя
                    "id": 5, - ID получателя
                    "username": "Commander" - логин получателя
                }
            },
            {
                "id": "387",
                "date": "2021-02-07T10:17:31+03:00",
                "user_id": 5,
                "admin_id": 5,
                "description": "Платеж картой через кассу на сумму 100 руб",
                "transaction_type": "income",
                "money": 100,
                "reservation_id": "",
                "branch_id": 1,
                "branch": {
                    "id": 1,
                    "name": "Королёв",
                    "city": "Краснодар",
                    "ip": "95.181.143.212",
                    "currency": "РУБ",
                    "currency_code": "RUB",
                    "time_zone": "+03:00",
                    "local_ip": "192.168.97.205",
                    "local_port": ""
                },
                "user": {
                    "id": 5,
                    "username": "Commander"
                }
            }
        ],
        "totalCount": 2
    }
}
